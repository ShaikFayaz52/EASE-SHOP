<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login — ShopEase</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header class="page site-header">
      <h1 class="logo">ShopEase</h1>
      <nav class="nav">
        <a href="index.html">Home</a>
        <a href="products.html">Products</a>
        <a href="orders.html">Orders</a>
        <a href="cart.html">Cart</a>
        <a href="login.html">Login</a>
      </nav>
    </header>

    <main class="page">
      <section class="hero-card" style="margin-top:8px;">
        <div class="hero-left">
          <span class="kicker">Welcome back</span>
          <h2>Sign in to ShopEase</h2>
          <p class="muted">Fast checkout, order tracking, and exclusive deals. Sign in to continue shopping.</p>
          <ul style="margin-top:14px;line-height:1.6;color:#374151">
            <li>Save multiple addresses</li>
            <li>View order history & tracking</li>
            <li>Secure payments & quick returns</li>
          </ul>
        </div>
        <div class="hero-right" style="background:linear-gradient(180deg,#fff,#f7fbff);color:#0f172a;box-shadow:none;align-items:flex-start;padding:20px;">
          <div class="auth-form" style="max-width:360px;width:100%;">
            <h2 style="text-align:left;margin-bottom:6px;color:#0f172a;">Sign in</h2>
            <div style="display:flex;gap:8px;margin-bottom:12px">
              <button id="tabEmail" class="text-button" style="flex:1">Email</button>
              <button id="tabPhone" class="text-button" style="flex:1">Phone</button>
            </div>

            <form id="emailForm" onsubmit="return false;">
              <label for="emailLogin">Email</label>
              <input id="emailLogin" type="email" placeholder="you@example.com" />
              <label for="passwordLogin">Password</label>
              <input id="passwordLogin" type="password" placeholder="Your password" />
              <div class="form-actions">
                <a href="#" class="text-button">Forgot?</a>
                <button id="emailSignInBtn" class="primary">Sign in</button>
              </div>
            </form>

            <form id="phoneForm" onsubmit="return false;" style="display:none;">
              <label for="phoneInput">Mobile Number</label>
              <input id="phoneInput" type="tel" placeholder="+91 98765 43210" />
              <div style="display:flex;gap:8px;margin-top:8px">
                <button id="sendOtpBtn" class="primary">Send OTP</button>
                <button id="verifyOtpBtn" class="primary" style="display:none">Verify</button>
              </div>
              <input id="otpInput" placeholder="Enter OTP" class="otp-input" style="margin-top:10px;display:block;width:100%;padding:8px;border-radius:8px;border:1px solid #e6e9ee" />
            </form>

            <div style="text-align:center;margin:12px 0;color:#6b7280">— or continue with —</div>
            <div style="display:flex;gap:10px;justify-content:center">
              <button id="googleSignIn" class="primary">Google</button>
            </div>

            <p style="text-align:center;margin-top:14px;color:#475569">New to ShopEase? <a href="register.html">Create an account</a></p>
          </div>
        </div>
      </section>
    </main>

    <footer class="page site-footer">
      <p>&copy; 2025 ShopEase. All rights reserved.</p>
    </footer>

    <!-- Firebase SDK: optional. If you want real SMS/email delivery, paste your config into `firebase-config.js` and include these scripts. -->
    <script src="firebase-config.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="auth.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function(){
        const phoneInput = document.getElementById('phoneInput');
        const sendBtn = document.getElementById('sendOtpBtn');
        const verifyBtn = document.getElementById('verifyOtpBtn');
        const otpInput = document.getElementById('otpInput');
        const googleBtn = document.getElementById('googleSignIn');
        const tabEmail = document.getElementById('tabEmail');
        const tabPhone = document.getElementById('tabPhone');
        const emailForm = document.getElementById('emailForm');
        const phoneForm = document.getElementById('phoneForm');

        function showEmail(){ emailForm.style.display='block'; phoneForm.style.display='none'; }
        function showPhone(){ emailForm.style.display='none'; phoneForm.style.display='block'; }
        tabEmail.addEventListener('click', showEmail);
        tabPhone.addEventListener('click', showPhone);

        document.getElementById('emailSignInBtn').addEventListener('click', function(e){
          e.preventDefault();
          const email = document.getElementById('emailLogin').value.trim();
          const pass = document.getElementById('passwordLogin').value.trim();
          if(!email || !pass){ alert('Enter email and password'); return; }
          window.appAuth.signInWithEmail(email, pass);
        });

        // allow pressing Enter on email form
        emailForm.addEventListener('submit', function(e){ e.preventDefault(); document.getElementById('emailSignInBtn').click(); });
        phoneForm.addEventListener('submit', function(e){ e.preventDefault(); sendBtn.click(); });

        sendBtn.addEventListener('click', function(e){
          e.preventDefault();
          const phone = phoneInput.value.trim();
          if(!phone){ alert('Enter phone number'); return; }
          if(window.FIREBASE_CONFIG && window.firebase && firebase.auth){
            window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('sendOtpBtn', { size: 'invisible' });
            firebase.auth().signInWithPhoneNumber(phone, window.recaptchaVerifier)
              .then(confirmationResult => { window.confirmationResult = confirmationResult; alert('OTP sent'); verifyBtn.style.display='inline-block'; })
              .catch(err => alert('Failed to send OTP: '+err.message));
            return;
          }
          window.appAuth.sendPhoneOtpDev(phone).then(()=>{ verifyBtn.style.display='inline-block'; });
        });

        verifyBtn.addEventListener('click', function(e){
          e.preventDefault();
          const phone = phoneInput.value.trim();
          const code = otpInput.value.trim();
          if(window.FIREBASE_CONFIG && window.firebase && window.confirmationResult){
            window.confirmationResult.confirm(code).then(result=>{ window.location.href='profile.html'; }).catch(err=>alert('Invalid code'));
            return;
          }
          const ok = window.appAuth.verifyOtpDev(phone, code);
          if(!ok) alert('Invalid OTP');
        });

        googleBtn.addEventListener('click', function(e){ e.preventDefault(); window.appAuth.signInWithGoogle(); });
      });
    </script>
</body>
</html>

